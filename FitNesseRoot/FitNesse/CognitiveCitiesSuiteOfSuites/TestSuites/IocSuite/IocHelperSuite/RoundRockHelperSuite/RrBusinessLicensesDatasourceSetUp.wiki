---
Help: Set up Round Rock Business Licenses data source
Test
---
<test page>

!define TEST_SYSTEM {slim}
!path   ./CognitiveCitiesTesting.jar

'''Include Variable Definitions'''

!include <IocSuite.IocServicesSuite.SetUpVariables

'''CREATE CSV DATASOURCES'''

'''Copy source csv to app server '''

| script |
| remote file copy; | ./testfiles/roundrock/${CSV_NAME_RR_BUSINESS_LICENSES} | /opt/IBM/ioc/csv/${CSV_NAME_RR_BUSINESS_LICENSES} | ${APPSERVER} | ${SSHUSER} | ${PRIVATEKEYFILE} | ${PRIVATEKEYPWD} |

'''Create i18n resources for the data source'''

| generic service validator fixture |
| requestType | serviceName | requestBody | customHeaders | getResponseCode? | getResponseMessage? | getResponseId? | getResultCount? | getUrl? |
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_DsLabel", "value":"Business Licenses (Fitnesse)","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_ID", "value":"ID","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_Status", "value":"Status","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_Latitude", "value":"Latitude","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_Longitude", "value":"Longitude","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_StartDate", "value":"StartDate","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_Year", "value":"Year","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_EndDate", "value":"EndDate","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_Name", "value":"Name","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_Street", "value":"Street","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_ZIP", "value":"ZIP","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_M", "value":"M","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"RRBusinessLicenses_Fitnesse_Description", "value":"Description","messages": []}|||||||

'''Create CSV type data source '''

| generic service validator fixture |
| requestType | serviceName | requestBody | customHeaders | getResponseCode? | getResponseMessage? | getResponseId? | getResultCount? | getUrl? |
| POST | /datasource-service/datasources/ | {"name":"${DS_NAME_RR_BUSINESS_LICENSES}","lastUpdateDate":1553559338404,"type":"CSV","scope":"DATASOURCE","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_DsLabel","i18nLabel":"Business Licenses (Fitnesse)","resources":[{"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_DsLabel","value":"Business Licenses (Fitnesse)"}]},"i18nLabel":"Business Licenses (Fitnesse)","description":{"group":"Fitnesse","key":"i18n_8c007b2f-2cfb-45d4-8969-84b3cd082c31","i18nLabel":"","resources":[{"id":82344,"lastUpdateDate":1553559410565,"group":"Fitnesse","locale":"en","key":"i18n_8c007b2f-2cfb-45d4-8969-84b3cd082c31","value":""}]},"receiver":{"type":"com.ibm.ioc.datareceiver.types.DataReceiverCSV","interval":1,"unit":"MINUTES","started":true},"source":{"protocol":"com.ibm.ioc.datasource.ColumnParserCsv","port":0,"directory":"/opt/IBM/ioc/csv/","filename":"${CSV_NAME_RR_BUSINESS_LICENSES}","persistData":true},"columns":[{"type":"VARCHAR","sourceType":"VARCHAR","sourceName":"0","targetNames":["NAME"],"hint":"ID","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_ID","i18nLabel":"ID","resources":[{"id":82227,"lastUpdateDate":1553559338282,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_ID","value":"ID"}]},"category":"MINIMAL","format":"STRING","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_f71d1cc6-6245-4789-8354-9af1291b3211","i18nLabel":"","resources":[{"id":82228,"lastUpdateDate":1553559338285,"group":"Fitnesse","locale":"en","key":"i18n_f71d1cc6-6245-4789-8354-9af1291b3211","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"VARCHAR","sourceType":"VARCHAR","sourceName":"1","targetNames":["STATUS"],"hint":"Status","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_Status","i18nLabel":"Status","resources":[{"id":82239,"lastUpdateDate":1553559338320,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_Status","value":"Status"}]},"category":"KEY","length":"200","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_d3bfd83d-0697-4a0c-8f6f-1cb1e65aaf78","i18nLabel":"","resources":[{"id":82240,"lastUpdateDate":1553559338324,"group":"Fitnesse","locale":"en","key":"i18n_d3bfd83d-0697-4a0c-8f6f-1cb1e65aaf78","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"VARCHAR","sourceType":"VARCHAR","sourceName":"10","targetNames":["LATITUDE"],"hint":"Latitude","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_Latitude","i18nLabel":"Latitude","resources":[{"id":82229,"lastUpdateDate":1553559338288,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_Latitude","value":"Latitude"}]},"category":"MINIMAL","format":"LAT_LON","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_5cf83021-bc9d-4794-9cf4-c4dc57249739","i18nLabel":"","resources":[{"id":82230,"lastUpdateDate":1553559338291,"group":"Fitnesse","locale":"en","key":"i18n_5cf83021-bc9d-4794-9cf4-c4dc57249739","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"VARCHAR","sourceType":"VARCHAR","sourceName":"11","targetNames":["LONGITUDE"],"hint":"Longitude","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_Longitude","i18nLabel":"Longitude","resources":[{"id":82231,"lastUpdateDate":1553559338295,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_Longitude","value":"Longitude"}]},"category":"MINIMAL","format":"LAT_LON","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_ad4f8005-a675-4cce-bab6-a7647fbe79f5","i18nLabel":"","resources":[{"id":82232,"lastUpdateDate":1553559338298,"group":"Fitnesse","locale":"en","key":"i18n_ad4f8005-a675-4cce-bab6-a7647fbe79f5","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"TIMESTAMP","sourceType":"VARCHAR","sourceName":"2","targetNames":["START"],"hint":"StartDate","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_StartDate","i18nLabel":"StartDate","resources":[{"id":82237,"lastUpdateDate":1553559338314,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_StartDate","value":"StartDate"}]},"category":"MINIMAL","format":"STRING","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_d81e6176-12a7-4638-b863-2fccafd75b9f","i18nLabel":"","resources":[{"id":82238,"lastUpdateDate":1553559338317,"group":"Fitnesse","locale":"en","key":"i18n_d81e6176-12a7-4638-b863-2fccafd75b9f","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"VARCHAR","sourceType":"VARCHAR","sourceName":"3","targetNames":["Year"],"hint":"Year","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_Year","i18nLabel":"Year","resources":[{"id":82243,"lastUpdateDate":1553559338333,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_Year","value":"Year"}]},"category":"FULL","length":"200","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_4c0893c9-4607-40f3-8dca-0c514e57d2ab","i18nLabel":"","resources":[{"id":82244,"lastUpdateDate":1553559338336,"group":"Fitnesse","locale":"en","key":"i18n_4c0893c9-4607-40f3-8dca-0c514e57d2ab","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"TIMESTAMP","sourceType":"VARCHAR","sourceName":"4","targetNames":["END"],"hint":"EndDate","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_EndDate","i18nLabel":"EndDate","resources":[{"id":82225,"lastUpdateDate":1553559338275,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_EndDate","value":"EndDate"}]},"category":"MINIMAL","format":"STRING","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_df0c5dbc-436b-4e3b-99d1-348351013390","i18nLabel":"","resources":[{"id":82226,"lastUpdateDate":1553559338279,"group":"Fitnesse","locale":"en","key":"i18n_df0c5dbc-436b-4e3b-99d1-348351013390","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"VARCHAR","sourceType":"VARCHAR","sourceName":"5","targetNames":["PROPERTY_NAME"],"hint":"Name","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_Name","i18nLabel":"Name","resources":[{"id":82235,"lastUpdateDate":1553559338308,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_Name","value":"Name"}]},"category":"KEY","length":"200","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_3352aba7-e739-40b1-b290-256cdeac96a6","i18nLabel":"","resources":[{"id":82236,"lastUpdateDate":1553559338311,"group":"Fitnesse","locale":"en","key":"i18n_3352aba7-e739-40b1-b290-256cdeac96a6","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"VARCHAR","sourceType":"VARCHAR","sourceName":"6","targetNames":["Street"],"hint":"Street","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_Street","i18nLabel":"Street","resources":[{"id":82241,"lastUpdateDate":1553559338327,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_Street","value":"Street"}]},"category":"KEY","length":"200","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_58e4ac40-cc82-4982-bcdb-b7a68d546666","i18nLabel":"","resources":[{"id":82242,"lastUpdateDate":1553559338330,"group":"Fitnesse","locale":"en","key":"i18n_58e4ac40-cc82-4982-bcdb-b7a68d546666","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"VARCHAR","sourceType":"VARCHAR","sourceName":"7","targetNames":["ZIP"],"hint":"ZIP","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_ZIP","i18nLabel":"ZIP","resources":[{"id":82245,"lastUpdateDate":1553559338339,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_ZIP","value":"ZIP"}]},"category":"FULL","length":"200","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_6a7f0301-e883-45a8-9b95-57c1b08e6e2c","i18nLabel":"","resources":[{"id":82246,"lastUpdateDate":1553559338342,"group":"Fitnesse","locale":"en","key":"i18n_6a7f0301-e883-45a8-9b95-57c1b08e6e2c","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"VARCHAR","sourceType":"VARCHAR","sourceName":"8","targetNames":["M"],"hint":"M","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_M","i18nLabel":"M","resources":[{"id":82233,"lastUpdateDate":1553559338301,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_M","value":"M"}]},"category":"FULL","length":"200","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_15312847-5aa7-403e-941c-6de79a00710d","i18nLabel":"","resources":[{"id":82234,"lastUpdateDate":1553559338305,"group":"Fitnesse","locale":"en","key":"i18n_15312847-5aa7-403e-941c-6de79a00710d","value":""}]},"userFilterInput":false,"displayedonMap":false},{"type":"VARCHAR","sourceType":"VARCHAR","sourceName":"9","targetNames":["Description"],"hint":"Description","label":{"group":"Fitnesse","key":"RRBusinessLicenses_Fitnesse_Description","i18nLabel":"Description","resources":[{"id":82223,"lastUpdateDate":1553559338269,"group":"Fitnesse","locale":"en","key":"RRBusinessLicenses_Fitnesse_Description","value":"Description"}]},"category":"KEY","length":"200","enumerated":false,"isId":false,"optimize":false,"updatable":true,"metric":false,"chart":false,"hidden":false,"ordinal":0,"hover":false,"previewCard":true,"helpMessage":{"group":"Fitnesse","key":"i18n_69150e7d-c7f3-47a0-833a-89e8c4b4ff0c","i18nLabel":"","resources":[{"id":82224,"lastUpdateDate":1553559338272,"group":"Fitnesse","locale":"en","key":"i18n_69150e7d-c7f3-47a0-833a-89e8c4b4ff0c","value":""}]},"userFilterInput":false,"displayedonMap":false}],"geometry":"POINT","dateFormat":"dd/MM/yy","timeFormat":"hh:mm","routingLogic":"AND","styleLogic":"AND","archive":1,"boundary":false,"boundaryFilterPane":false,"correlation":false,"report":false,"table":"IOC.TARGET_TABLE_${TT_NAME_RR_BUSINESS_LICENSES}","view":"IOC.TARGET_VIEW_${TT_NAME_RR_BUSINESS_LICENSES}","serverRendering":false,"nonTrustedSource":false,"comments":false,"voting":false,"imageUploads":false,"icon":"store.png","radius":0.0,"sides":0,"styles":[{"name":"_base_","label":{},"type":"COLOR","line":"#000000","value":"#d3d3d3","weight":1,"opacity":1.0,"scope":"DATASOURCE"}],"extensions":[{"name":"category","label":{},"type":"CUSTOM","disabled":false,"multiple":false,"module":"ICPO","associated":"1"},{"name":"dimension","label":{},"type":"CUSTOM","disabled":false,"multiple":false,"module":"ICPO","associated":"false"},{"name":"name","label":{},"type":"CUSTOM","disabled":false,"multiple":false,"module":"ICPO","associated":"RRBusinessLicenses"},{"name":"resource","label":{},"type":"CUSTOM","disabled":false,"multiple":false,"module":"ICPO","associated":"false"}],"optionalDateTime":false,"minZoomForLoad":0} | | 200 | | $DSID_RRBUSLIC= | | |
| GET | /datasource-service/datasources/$DSID_RRBUSLIC | | | 200 | =~/(?i)"Name":"${DS_NAME_RR_BUSINESS_LICENSES}"/ | | 1 | |

| script |
| #''Give data receiver time to receive records'' |
| time delay ; | 10000 |

'''Verify the target table has the correct number of records'''

| generic database fixture |
| connectionName | statementType | statementText | responseFormat | getResponse? | getResultCount? | getResponseMessage? |getFirstResultField?|
| iocdata | read | select count as count from ioc.TARGET_TABLE_${TT_NAME_RR_BUSINESS_LICENSES} | json | [{"COUNT":3024}] | 1 | OK |3024|

---
Help: Create ICA Adult Arrests Datasource
Test
---
<test page>

!define TEST_SYSTEM {slim}
!path   ./CognitiveCitiesTesting.jar

'''Include Variable Definitions'''

!include <IocSuite.IocServicesSuite.SetUpVariables

'''Create i18n resources for the data source'''

| generic service validator fixture |
| requestType | serviceName | requestBody | customHeaders | getResponseCode? | getResponseMessage? | getResponseId? | getResultCount? | getUrl? |
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICAAdultArrests_Fitnesse_DsLabel", "value":"Arrests - Adult (Fitnesse)","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICAAdultArrests_Fitnesse_ARRESTDATE", "value":"ARRESTDATE","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICAAdultArrests_Fitnesse_ARRID", "value":"ARRID","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICAAdultArrests_Fitnesse_CHARGES", "value":"CHARGES","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICAAdultArrests_Fitnesse_CSNUM", "value":"CSNUM","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICAAdultArrests_Fitnesse_LASTUPDATE", "value":"LASTUPDATE","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICAAdultArrests_Fitnesse_PRCRIMHIS", "value":"PRCRIMHIS","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICAAdultArrests_Fitnesse_SUBJECTID", "value":"SUBJECTID","messages": []}|||||||

'''CREATE DATABASE TYPE DATASOURCE'''

| generic service validator fixture |
| requestType | serviceName | requestBody | customHeaders | getResponseCode? | getResponseMessage? | getResponseId? | getResultCount? | getUrl? |
| POST | /datasource-service/datasources/ | { "name": "${DS_NAME_ICA_ADULT_ARRESTS}", "type": "Database", "scope": "DATASOURCE", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_DsLabel", "i18nLabel": "Arrests - Adult (Fitnesse)" }, "i18nLabel": "Arrests - Adult (Fitnesse)", "description": { "group": "Fitnesse", "key": "i18n_8c007b2f-2cfb-45d4-8969-84b3cd082c31", "i18nLabel": "i18n_8c007b2f-2cfb-45d4-8969-84b3cd082c31" }, "receiver": { "type": "com.ibm.ioc.datareceiver.types.DataReceiverTable", "interval": 0, "unit": "MINUTES", "started": false }, "source": { "protocol": "com.ibm.ioc.datasource.ColumnParserDatabase", "options": "DB2", "host": "${DBSERVER}", "port": 50000, "user": "${DBUSER}", "password": "${DBPASSWORD}", "directory": "iocdata", "filename": "${DB_NAME_ICA_ADULT_ARRESTS}", "persistData": true }, "columns": [ { "type": "TIMESTAMP", "sourceType": "TIMESTAMP", "sourceName": "ARRESTDATE", "targetNames": [ "START_DATE_TIME", "END_DATE_TIME" ], "hint": "ARRESTDATE", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_ARRESTDATE", "i18nLabel": "ARRESTDATE" }, "category": "MINIMAL", "format": "TIMESTAMP", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_d450761e-8c86-4898-9c69-51180307246f", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "INTEGER", "sourceName": "ARRID", "targetNames": [ "NAME" ], "hint": "ARRID", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_ARRID", "i18nLabel": "ARRID" }, "category": "MINIMAL", "format": "STRING", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_83c85078-85ae-4ff6-8e19-c5a758556d5c", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "CHARGES", "targetNames": [ "CHARGES" ], "hint": "CHARGES", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_CHARGES", "i18nLabel": "CHARGES" }, "category": "KEY", "length": "200", "enumerated": true, "isId": false, "optimize": true, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_9528b746-464b-49ab-bd49-ee81a7e93a68", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "CSNUM", "targetNames": [ "CSNUM" ], "hint": "CSNUM", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_CSNUM", "i18nLabel": "CSNUM" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_24bb0363-8ada-4102-86ae-ae9a7a1a9e86", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "TIMESTAMP", "sourceType": "TIMESTAMP", "sourceName": "LASTUPDATE", "targetNames": [ "LAST_UPDATE_DATE_TIME" ], "hint": "LASTUPDATE", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_LASTUPDATE", "i18nLabel": "LASTUPDATE" }, "category": "MINIMAL", "format": "TIMESTAMP", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_ee7bc5ff-85b9-45f6-bf99-64d690eb7591", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "PRCRIMHIS", "targetNames": [ "PRCRIMHIS" ], "hint": "PRCRIMHIS", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_PRCRIMHIS", "i18nLabel": "PRCRIMHIS" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_80a42ff5-748e-45c8-9362-b66f27cdf2a2", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "INTEGER", "sourceType": "INTEGER", "sourceName": "SUBJECTID", "targetNames": [ "SUBJECTID" ], "hint": "SUBJECTID", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_SUBJECTID", "i18nLabel": "SUBJECTID" }, "category": "FULL", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_dc716025-9e0f-40a6-a5c2-c10f1bf5ef58", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false } ], "geometry": "NONE", "routingLogic": "AND", "styleLogic": "AND", "archive": 1, "boundary": false, "boundaryFilterPane": false, "correlation": false, "report": false, "table": "IOC.TARGET_TABLE_${TT_NAME_ICA_ADULT_ARRESTS}", "view": "IOC.TARGET_VIEW_${TT_NAME_ICA_ADULT_ARRESTS}", "serverRendering": false, "nonTrustedSource": false, "comments": false, "voting": false, "imageUploads": false, "icon": "311.png", "radius": 0, "sides": 0, "styles": [ { "name": "_base_", "label": {}, "type": "COLOR", "line": "#000000", "value": "#d3d3d3", "weight": 1, "opacity": 1, "scope": "DATASOURCE" } ], "extensions": [ { "name": "category", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "1" }, { "name": "dimension", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "false" }, { "name": "name", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "${DB_NAME_ICA_ADULT_ARRESTS}" }, { "name": "resource", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "false" } ], "optionalDateTime": false, "minZoomForLoad": 0, "dateFormat":"", "timeFormat":"", "areas":"", "rules":[ ] } | | 200 | | $DSID_ICAADULTARRESTS= | | |
| GET | /datasource-service/datasources/$DSID_ICAADULTARRESTS | | | 200 | =~/(?i)"Name":"${DS_NAME_ICA_ADULT_ARRESTS}"/ | | 1 | |
| PUT | /datasource-service/datasources/$DSID_ICAADULTARRESTS?forceUpdate=true | { "id": $DSID_ICAADULTARRESTS, "name": "${DS_NAME_ICA_ADULT_ARRESTS}", "type": "Database", "scope": "DATASOURCE", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_DsLabel", "i18nLabel": "Arrests - Adult (Fitnesse)" }, "i18nLabel": "Arrests - Adult (Fitnesse)", "description": { "group": "Fitnesse", "key": "i18n_8c007b2f-2cfb-45d4-8969-84b3cd082c31", "i18nLabel": "i18n_8c007b2f-2cfb-45d4-8969-84b3cd082c31" }, "receiver": { "id": 0, "type": "com.ibm.ioc.datareceiver.types.DataReceiverTable", "interval": 0, "unit": "MINUTES", "started": true }, "source": { "protocol": "com.ibm.ioc.datasource.ColumnParserDatabase", "options": "DB2", "host": "${DBSERVER}", "port": 50000, "user": "${DBUSER}", "directory": "iocdata", "filename": "${DB_NAME_ICA_ADULT_ARRESTS}", "persistData": true }, "columns": [ { "type": "TIMESTAMP", "sourceType": "TIMESTAMP", "sourceName": "ARRESTDATE", "targetNames": [ "START_DATE_TIME", "END_DATE_TIME" ], "hint": "ARRESTDATE", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_ARRESTDATE", "i18nLabel": "ARRESTDATE" }, "category": "MINIMAL", "format": "TIMESTAMP", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_d450761e-8c86-4898-9c69-51180307246f", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "INTEGER", "sourceName": "ARRID", "targetNames": [ "NAME" ], "hint": "ARRID", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_ARRID", "i18nLabel": "ARRID" }, "category": "MINIMAL", "format": "STRING", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_83c85078-85ae-4ff6-8e19-c5a758556d5c", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "CHARGES", "targetNames": [ "CHARGES" ], "hint": "CHARGES", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_CHARGES", "i18nLabel": "CHARGES" }, "category": "KEY", "length": "200", "enumerated": true, "isId": false, "optimize": true, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_9528b746-464b-49ab-bd49-ee81a7e93a68", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "CSNUM", "targetNames": [ "CSNUM" ], "hint": "CSNUM", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_CSNUM", "i18nLabel": "CSNUM" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_24bb0363-8ada-4102-86ae-ae9a7a1a9e86", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "TIMESTAMP", "sourceType": "TIMESTAMP", "sourceName": "LASTUPDATE", "targetNames": [ "LAST_UPDATE_DATE_TIME" ], "hint": "LASTUPDATE", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_LASTUPDATE", "i18nLabel": "LASTUPDATE" }, "category": "MINIMAL", "format": "TIMESTAMP", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_ee7bc5ff-85b9-45f6-bf99-64d690eb7591", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "PRCRIMHIS", "targetNames": [ "PRCRIMHIS" ], "hint": "PRCRIMHIS", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_PRCRIMHIS", "i18nLabel": "PRCRIMHIS" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_80a42ff5-748e-45c8-9362-b66f27cdf2a2", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "INTEGER", "sourceType": "INTEGER", "sourceName": "SUBJECTID", "targetNames": [ "SUBJECTID" ], "hint": "SUBJECTID", "label": { "group": "Fitnesse", "key": "ICAAdultArrests_Fitnesse_SUBJECTID", "i18nLabel": "SUBJECTID" }, "category": "FULL", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_dc716025-9e0f-40a6-a5c2-c10f1bf5ef58", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false } ], "geometry": "NONE", "routingLogic": "AND", "styleLogic": "AND", "archive": 1, "boundary": false, "boundaryFilterPane": false, "correlation": false, "report": false, "table": "IOC.TARGET_TABLE_${TT_NAME_ICA_ADULT_ARRESTS}", "view": "IOC.TARGET_VIEW_${TT_NAME_ICA_ADULT_ARRESTS}", "serverRendering": false, "nonTrustedSource": false, "comments": false, "voting": false, "imageUploads": false, "icon": "311.png", "radius": 0, "sides": 0, "styles": [ { "name": "_base_", "label": {}, "type": "COLOR", "line": "#000000", "value": "#d3d3d3", "weight": 1, "opacity": 1, "scope": "DATASOURCE" } ], "extensions": [ { "name": "category", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "1" }, { "name": "dimension", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "false" }, { "name": "name", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "${DB_NAME_ICA_ADULT_ARRESTS}" }, { "name": "resource", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "false" } ], "optionalDateTime": false, "minZoomForLoad": 0, "dateFormat":"", "timeFormat":"", "areas":"", "rules":[ ] } | | 200 | |  | | |

| script |
| #''Give data receiver time to receive records'' |
| time delay ; | 10000 |

'''Verify the target table has the correct number of records'''

| generic database fixture |
| connectionName | statementType | statementText | responseFormat | getResponse? | getResultCount? | getResponseMessage? |getFirstResultField?|
| iocdata | read | select count as count from ioc.TARGET_TABLE_${TT_NAME_ICA_ADULT_ARRESTS} | json | [{"COUNT":706}] | 1 | OK |706|

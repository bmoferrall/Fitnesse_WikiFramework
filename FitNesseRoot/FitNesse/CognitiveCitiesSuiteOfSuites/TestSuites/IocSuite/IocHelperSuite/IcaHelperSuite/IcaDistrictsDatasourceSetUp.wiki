---
Help: Create ICA Districts Datasource
Test
---
<test page>

!define TEST_SYSTEM {slim}
!path   ./CognitiveCitiesTesting.jar

'''Include Variable Definitions'''

!include <IocSuite.IocServicesSuite.SetUpVariables

'''Create i18n resources for the data source'''

| generic service validator fixture |
| requestType | serviceName | requestBody | customHeaders | getResponseCode? | getResponseMessage? | getResponseId? | getResultCount? | getUrl? |
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_DsLabel", "value":"Districts (Fitnesse)","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_AGENCY", "value":"AGENCY","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_AGENCYURL", "value":"AGENCYURL","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_CENTROID_X", "value":"CENTROID_X","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_CENTROID_Y", "value":"CENTROID_Y","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_CONTACT", "value":"CONTACT","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_DISTRICTID", "value":"DISTRICTID","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_EMAIL", "value":"EMAIL","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_LASTEDITOR", "value":"LASTEDITOR","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_LASTUPDATE", "value":"LASTUPDATE","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_LOCATION", "value":"LOCATION","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_NAME", "value":"NAME","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_OBJECTID", "value":"OBJECTID","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_PHONE", "value":"PHONE","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_SHAPE_Area", "value":"SHAPE_Area","messages": []}|||||||
|POST|/i18n-service/resources|{"group": "Fitnesse", "locale":"en", "key":"ICADistricts_Fitnesse_SHAPE_Leng", "value":"SHAPE_Leng","messages": []}|||||||

'''CREATE DATABASE TYPE DISTRICTS DATASOURCE'''

| generic service validator fixture |
| requestType | serviceName | requestBody | customHeaders | getResponseCode? | getResponseMessage? | getResponseId? | getResultCount? | getUrl? |
| POST | /datasource-service/datasources/ | { "name": "${DS_NAME_ICA_DISTRICTS}", "type": "Database", "scope": "DATASOURCE", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_DsLabel", "i18nLabel": "Districts (Fitnesse)" }, "i18nLabel": "Districts (Fitnesse)", "description": {}, "receiver": { "type": "com.ibm.ioc.datareceiver.types.DataReceiverTable", "interval": 0, "unit": "MINUTES", "started": true }, "source": { "protocol": "com.ibm.ioc.datasource.ColumnParserDatabase", "options": "DB2", "host": "${DBSERVER}", "port": 50000, "user": "${DBUSER}", "password": "${DBPASSWORD}", "directory": "iocdata", "filename": "${DB_NAME_ICA_DISTRICTS}", "persistData": true }, "columns": [ { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "AGENCY", "targetNames": [ "AGENCY" ], "hint": "AGENCY", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_AGENCY", "i18nLabel": "AGENCY" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_e13d8499-9264-4456-9880-5daf51214de8", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "AGENCYURL", "targetNames": [ "AGENCYURL" ], "hint": "AGENCYURL", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_AGENCYURL", "i18nLabel": "AGENCYURL" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_32604e41-ab63-4b0c-84ac-988ba115b760", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "DOUBLE", "sourceType": "DOUBLE", "sourceName": "CENTROID_X", "targetNames": [ "CENTROID_X" ], "hint": "CENTROID_X", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_CENTROID_X", "i18nLabel": "CENTROID_X" }, "category": "FULL", "enumerated": true, "isId": false, "optimize": true, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_972e62b6-8a07-461d-8dfb-b24f0ee15aa0", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "DOUBLE", "sourceType": "DOUBLE", "sourceName": "CENTROID_Y", "targetNames": [ "CENTROID_Y" ], "hint": "CENTROID_Y", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_CENTROID_Y", "i18nLabel": "CENTROID_Y" }, "category": "FULL", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_5bf51b43-e8b4-4d0e-84c1-32c40f31109a", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "CONTACT", "targetNames": [ "CONTACT" ], "hint": "CONTACT", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_CONTACT", "i18nLabel": "CONTACT" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_1ac9433b-098c-42e7-a364-225d0fb2866c", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "DISTRICTID", "targetNames": [ "NAME" ], "hint": "DISTRICTID", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_DISTRICTID", "i18nLabel": "DISTRICTID" }, "category": "MINIMAL", "format": "STRING", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_add6320e-db08-4047-986a-07d67b263163", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "EMAIL", "targetNames": [ "EMAIL" ], "hint": "EMAIL", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_EMAIL", "i18nLabel": "EMAIL" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_d4ed9687-9d8c-446e-9acd-fc70d2d7551e", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "LASTEDITOR", "targetNames": [ "LASTEDITOR" ], "hint": "LASTEDITOR", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_LASTEDITOR", "i18nLabel": "LASTEDITOR" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_065391c1-61ff-49dd-ae3b-46d34df37114", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "DATE", "sourceType": "DATE", "sourceName": "LASTUPDATE", "targetNames": [ "LASTUPDATE" ], "hint": "LASTUPDATE", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_LASTUPDATE", "i18nLabel": "LASTUPDATE" }, "category": "FULL", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_33e0cb65-c312-4dad-b0f7-d4248c644e87", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "\"DB2GSE\".\"ST_MULTIPOLYGON\"", "sourceName": "LOCATION", "targetNames": [ "LOCATION" ], "hint": "LOCATION", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_LOCATION", "i18nLabel": "LOCATION" }, "category": "MINIMAL", "format": "SHAPE", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_25e1e005-5128-4d18-ade6-842cad34118c", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "NAME", "targetNames": [ "Property_NAME" ], "hint": "NAME", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_NAME", "i18nLabel": "NAME" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_31ebccba-8aec-4be5-a7b3-09720715dba1", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "INTEGER", "sourceType": "INTEGER", "sourceName": "OBJECTID", "targetNames": [ "Property_OBJECTID" ], "hint": "OBJECTID", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_OBJECTID", "i18nLabel": "OBJECTID" }, "category": "FULL", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_d4a8e3c3-ec62-42b3-9809-7d333dd7b3f6", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "VARCHAR", "sourceType": "VARCHAR", "sourceName": "PHONE", "targetNames": [ "PHONE" ], "hint": "PHONE", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_PHONE", "i18nLabel": "PHONE" }, "category": "FULL", "length": "200", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_950b176f-514a-4ad0-96dd-706e3f28a578", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "DOUBLE", "sourceType": "DOUBLE", "sourceName": "SHAPE_Area", "targetNames": [ "SHAPE_Area" ], "hint": "SHAPE_Area", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_SHAPE_Area", "i18nLabel": "SHAPE_Area" }, "category": "FULL", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_4c9aff1d-401e-48b3-bc41-e08b16dac066", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false }, { "type": "DOUBLE", "sourceType": "DOUBLE", "sourceName": "SHAPE_Leng", "targetNames": [ "SHAPE_Leng" ], "hint": "SHAPE_Leng", "label": { "group": "Fitnesse", "key": "ICADistricts_Fitnesse_SHAPE_Leng", "i18nLabel": "SHAPE_Leng" }, "category": "FULL", "enumerated": false, "isId": false, "optimize": false, "updatable": true, "metric": false, "chart": false, "hidden": false, "ordinal": 0, "hover": false, "previewCard": true, "helpMessage": { "group": "Fitnesse", "key": "i18n_827c09a5-da47-49b9-a5e8-28dac0a714de", "i18nLabel": "" }, "userFilterInput": false, "displayedonMap": false } ], "geometry": "MULTIPOLYGON", "routingLogic": "AND", "styleLogic": "AND", "archive": 1, "boundary": true, "boundaryFilterPane": false, "correlation": false, "report": false, "table": "IOC.TARGET_TABLE_${TT_NAME_ICA_DISTRICTS}", "view": "IOC.TARGET_VIEW_${TT_NAME_ICA_DISTRICTS}", "serverRendering": false, "nonTrustedSource": false, "comments": false, "voting": false, "imageUploads": false, "icon": "311.png", "radius": 0, "sides": 0, "styles": [ { "name": "_base_", "label": {}, "type": "COLOR", "line": "#000000", "value": "#d3d3d3", "weight": 1, "opacity": 1, "scope": "DATASOURCE" } ], "extensions": [ { "name": "category", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "1" }, { "name": "dimension", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "false" }, { "name": "name", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "${DB_NAME_ICA_DISTRICTS}" }, { "name": "resource", "label": {}, "type": "CUSTOM", "disabled": false, "multiple": false, "module": "ICPO", "associated": "false" } ], "optionalDateTime": true, "minZoomForLoad": 0 } | | 200 | | $DSID_ICADISTRICTS= | | |
| GET | /datasource-service/datasources/$DSID_ICADISTRICTS | | | 200 | =~/(?i)"Name":"${DS_NAME_ICA_DISTRICTS}"/ | | 1 | |

| script |
| #''Give data receiver time to receive records'' |
| time delay ; | 10000 |

'''Verify the target table has the correct number of records'''

| generic database fixture |
| connectionName | statementType | statementText | responseFormat | getResponse? | getResultCount? | getResponseMessage? |getFirstResultField?|
| iocdata | read | select count as count from ioc.TARGET_TABLE_${TT_NAME_ICA_DISTRICTS} | json | [{"COUNT":3}] | 1 | OK |3|
